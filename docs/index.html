<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Cloth Simulator Project | Gan Tu">
<meta name="author" content="">
<link rel="icon" href="assets/img/favicon.ico">
<title>Cloth Simulator Project | Gan Tu</title>
<!-- Bootstrap core CSS -->
<link href="assets/css/bootstrap.min.css" rel="stylesheet">
<!-- Fonts -->
<link href="assets/css/font-awesome.min.css" rel="stylesheet">
<link href="assets/css/font.css" rel="stylesheet">
<!-- Custom styles for this template -->
<link href="assets/css/mediumish.css" rel="stylesheet">
<link href="assets/css/monokai-sublime.css" rel="stylesheet">
<link href="assets/css/custom.css" rel="stylesheet">
</head>
<body>

<!-- Begin Nav
================================================== -->
<nav class="navbar navbar-toggleable-md navbar-light bg-white fixed-top mediumnavigation">
<button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
<span class="navbar-toggler-icon"></span>
</button>
<div class="container">
	<!-- Begin Logo -->
	<a class="navbar-brand" href="index.html">
	<img src="./assets/img/logo.png" alt="logo">
	</a>
	<!-- End Logo -->
		<div class="collapse navbar-collapse" id="navbarsExampleDefault">
		<!-- Begin Menu -->
		<ul class="navbar-nav ml-auto">
			<li class="nav-item active">
			<a class="nav-link" href="index.html">Deliverable <span class="sr-only">(current)</span></a>
			</li>
			<li class="nav-item">
			<a class="nav-link" href="https://michael-tu.github.io/Cloth-Simulator" target="_blank">GitHub</a>
			</li>
		</ul>
		<!-- End Menu -->
	</div>
</div>
</nav>
<!-- End Nav
================================================== -->


<!-- Return to Top -->
<a href="javascript:" id="return-to-top">
	<i class="fa fa-chevron-up"></i>
</a>


<!-- Begin Article
================================================== -->
<div class="container">
	<div class="row">

		<div class="col-md-1 col-xs-12"></div>
		<!-- Begin Post -->
		<div class="col-md-10 col-md-offset-2 col-xs-12">
			<div class="mainheading">

				<!-- Begin Top Meta -->
				<div class="row post-top-meta">
					<div class="col-md-2">
						<a href="http://github.tugan.me"><img class="author-thumb" src="./assets/img/profile-pic.jpg" alt="Gan Tu's Profile Picture"></a>
					</div>
					<div class="col-md-10">
						<a class="link-dark">Gan Tu (Michael)</a>
						<span class="author-description">Student of CS 184: Computer Graphics and Imaging, Spring 2018 at UC Berkeley.</span>
						<span class="post-date" id="post-date">6 April 2018</span><span class="dot"></span><span class="post-read">10 min read</span>
					</div>
				</div>
				<!-- End Top Menta -->

				<h1 class="posttitle">Project Cloth Simulator</h1>

			</div>

			<!-- Begin Featured Image -->
			<img class="featured-image img-fluid" src="./assets/img/post/cloth.jpg" alt="featured blog image - tiger">
			<!-- End Featured Image -->

			<!-- Begin Post Content -->
			<div class="article-post">

				<h2 id="overview"><b>Overview</b></h2>

				<p>In this project, I will implement a real-time simulation of cloth using a mass and spring based system. I will build the data structures to discretely represent the cloth, define and apply physical constraints on them, and apply numerical integration to simulate the way cloth moves over time. Finally, I will implement collisions with other objects as well as self-collisions to prevent cloth clipping.</p>

				<p>This project is very interesting and it is simply astounding how we can make such realistic physical simulations based on very few, basic physics mechanisms. I cannot help but wonder what the physical simulations will look like if we incorporate more complicated and sophisticated physics into the simulation. I am definitely intrigued by this field of graphics and would like to explore in this domain.</p>

				<h2 id="part1"><b>Part 1: Masses and springs</b></h2>

				<p>Throughout the history of computer graphics, many different cloth models have been developed for simulation. Of these, one of the simplest models uses a system of point masses and springs, which I will use for this project.</p>

				<p>Given a sheet of cloth with some desired dimensions and parameters, we can first divide the cloth up into evenly spaced point masses and then connect nearby masses with springs. If the cloth's orientation is horizontal, we set the y coordinate for all point masses to 1 while varying positions over the xz plane. Otherwise, we generate a small random offset between -1/1000 and 1/1000 for each point mass and use that as the z coordinate while varying positions over the xy plane.</p>

				<p>Next, we add constraints between point masses via springs. There exists three types of constraints, which of all I've implemented in this project:
					<ul>
						<li><b>Structural constraints</b> exist between a point mass and the point mass to its left as well as the point mass above it.</li> 
						<li><b>Shearing constraints</b> exist between a point mass and the point mass to its diagonal upper left as well as the point mass to its diagonal upper right.</li>
						<li><b>Bending constraints</b> exist between a point mass and the point mass two away to its left as well as the point mass two above it.</li>
					</ul>
				</p>

				<p>Below shows the detailed structure of my point masses and springs in a the cloth wireframe:</p>

				<div class="row" id="point-masses-and-springs">
					<div class="col-md-6">
						<figure class="figure">
							<img src="./assets/img/result/part1/part1-closeup-1.jpg" class="figure-img img-fluid rounded" alt="Cloth Wireframe (2 corners pinned)">
							<figcaption class="figure-caption text-center">Cloth Wireframe (2 corners pinned)</figcaption>
						</figure>
					</div>
					<div class="col-md-6">
						<figure class="figure">
							<img src="./assets/img/result/part1/part1-closeup-2.jpg" class="figure-img img-fluid rounded" alt="Cloth Wireframe (2 corners pinned)">
							<figcaption class="figure-caption text-center">Cloth Wireframe (2 corners pinned)</figcaption>
						</figure>
					</div>
				</div>

				<p>As we can see, point masses are evenly spaced out in the wireframe, with springs connecting each other forming a well defined structure.</p>

				<p>Below shows what the wireframe looks like without any shearing constraints,  with only shearing constraints, and with all constraints:</p>
				
				<div class="row">
					<div class="col-md-6">
						<figure class="figure">
							<img src="./assets/img/result/part1/part1-without-shearing.jpg" class="figure-img img-fluid rounded" alt="Without Shearing Constraints">
							<figcaption class="figure-caption text-center">Without Shearing Constraints</figcaption>
						</figure>
					</div>
					<div class="col-md-6">
						<figure class="figure">
							<img src="./assets/img/result/part1/part1-only-shearing.jpg" class="figure-img img-fluid rounded" alt="Only Shearing Constraints">
							<figcaption class="figure-caption text-center">Only Shearing Constraints</figcaption>
						</figure>
					</div>
					<div class="col-md-6">
						<figure class="figure">
							<img src="./assets/img/result/part1/part1-all.jpg" class="figure-img img-fluid rounded" alt="All Constraints Wireframe">
							<figcaption class="figure-caption text-center">All Constraints Wireframe</figcaption>
						</figure>
					</div>
					<div class="col-md-6">
						<figure class="figure">
							<img src="./assets/img/result/part1/part1-shaded.jpg" class="figure-img img-fluid rounded" alt="All Constraints Shaded">
							<figcaption class="figure-caption text-center">All Constraints Shaded</figcaption>
						</figure>
					</div>
				</div>

				<p>As you can see, shearing constraints are mainly the diagonal springs between point masses in the cloth wireframe to hold and maintain the square shape of cloth.</p>

				
				<h2 id="part2"><b>Part 2: Simulation via numerical integration</b></h2>

				<p>Now that we have set up the cloth model as a system of masses and springs, we need to integrate the physical equations of motion in order to apply the forces on our cloth's point masses to figure out how they move from one time step to the next.</p>

				<p>Specifically, there are two kinds of forces: <b>external forces</b> such as gravity, which uniformly affect the cloth, and <b>spring correction forces</b>, which apply the spring constraints from before to keep the cloth together. The spring correction forces also vary between point masses based on the state of each spring. </p>

				<p>To simulate this, we first uniformly apply the external forces on every point mass, and then compute the forces applied to the two masses on each spring using Hooke's law: </p>

				<div class="text-center">
					<figure class="figure">
                        <img src="./assets/img/post/hooke's-law.png" class="figure-img img-fluid rounded" alt="Hooke's Law" width="250px">
                        <figcaption class="figure-caption text-center">Hooke's Law</figcaption>
                    </figure>
				</div>

				<p>where k_s is the spring constant, p_a and p_b are the positions of the two masses, || indicates magnitude, and l is the spring's rest length. Because the bending constraint should be weaker that structural or shearing constraints, I use 0.2 * k_s as a weakened spring constant if the spring represents a bending constraint.</p>

				<p>Having computed all the forces acted upon on each point mass for this time step, we perform numerical integration to compute each point mass's change in position. Here, I will use Verlet integration as follows</p>

				<div class="text-center">
					<figure class="figure">
                        <img src="./assets/img/post/verlet-integration.png" class="figure-img img-fluid rounded" alt="Verlet Integration" width="400px">
                        <figcaption class="figure-caption text-center">Verlet Integration</figcaption>
                    </figure>
				</div>

				<p>where x_t is the current position, x_t-dt is position from last time step, a_t is the current acceleration from all forces, d_t is the timestep, and d is the damping term that helps simulate the loss of energy due to friction, heat loss, etc. </p>

				<p>Here are some simulations for a falling cloth with two corners pinned:</p>

				<div class="row">
					<div class="col-md-6">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part2/part2-wireframe-animation.gif" class="figure-img img-fluid rounded" alt="Wireframe Cloth Animation">
	                        <figcaption class="figure-caption text-center">Wireframe Cloth Animation</figcaption>
	                    </figure>
	                </div>
	                <div class="col-md-6">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part2/part2-shaded-animation.gif" class="figure-img img-fluid rounded" alt="Shaded Cloth Animation">
	                        <figcaption class="figure-caption text-center">Shaded Cloth Animation</figcaption>
	                    </figure>
	                </div>
                </div>


                <p>The behavior and simulation of cloths also change as we modify the different parameters. Let's observe any noticeable differences in the cloth compared to the default parameters: spring constant k = 5000 N/m and density of 15 g/cm^2.</p>

                <p>Below are side-by-side comparisons of the cloth with different spring constants.</p>

				<div class="row">
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part2/part2-k200.jpg" class="figure-img img-fluid rounded" alt="Spring Constant k = 200">
					        <figcaption class="figure-caption text-center">Spring Constant k = 200</figcaption>
					    </figure>
					</div>
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part2/part2-default.jpg" class="figure-img img-fluid rounded" alt="Default Spring Constant">
					        <figcaption class="figure-caption text-center"><b>Default</b> Spring Constant</figcaption>
					    </figure>
					</div>
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part2/part2-k50000.jpg" class="figure-img img-fluid rounded" alt="Spring Constant k = 50000">
					        <figcaption class="figure-caption text-center">Spring Constant k = 50000</figcaption>
					    </figure>
					</div>
				</div>

				<div class="row">
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part2/part2-k200-shaded.jpg" class="figure-img img-fluid rounded" alt="Spring Constant k = 200">
					        <figcaption class="figure-caption text-center">Spring Constant k = 200</figcaption>
					    </figure>
					</div>
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part2/part2-default-shaded.jpg" class="figure-img img-fluid rounded" alt="Default Spring Constant">
					        <figcaption class="figure-caption text-center"><b>Default</b> Spring Constant</figcaption>
					    </figure>
					</div>
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part2/part2-k50000-shaded.jpg" class="figure-img img-fluid rounded" alt="Spring Constant k = 50000">
					        <figcaption class="figure-caption text-center">Spring Constant k = 50000</figcaption>
					    </figure>
					</div>
				</div>

				<p>As we can see, as we increase the spring constant, the cloth is less loose and the middle part of the cloth between the two pinned corners are less dragged down. It makes sense as a higher spring constant means a higher shearing constraint to prevent the cloth from changing the shape.</p>

				<p>Below are side-by-side comparisons of the cloth with different density.</p>

				<div class="row">
					<div class="col-md-4">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part2/part2-density5.jpg" class="figure-img img-fluid rounded" alt="Density d = 5">
	                        <figcaption class="figure-caption text-center">Density d = 5</figcaption>
	                    </figure>
	                </div>
	                <div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part2/part2-default.jpg" class="figure-img img-fluid rounded" alt="Default Density d = 15">
					        <figcaption class="figure-caption text-center"><b>Default</b> Density d = 15</figcaption>
					    </figure>
					</div>
	                <div class="col-md-4">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part2/part2-density30.jpg" class="figure-img img-fluid rounded" alt="Density d = 30">
	                        <figcaption class="figure-caption text-center">Density d = 30</figcaption>
	                    </figure>
	                </div>
				</div>

				<div class="row">
					<div class="col-md-4">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part2/part2-density5-shaded.jpg" class="figure-img img-fluid rounded" alt="Density d = 5">
	                        <figcaption class="figure-caption text-center">Density d = 5</figcaption>
	                    </figure>
	                </div>
	                <div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part2/part2-default-shaded.jpg" class="figure-img img-fluid rounded" alt="Default Density d = 15">
					        <figcaption class="figure-caption text-center"><b>Default</b> Density d = 15</figcaption>
					    </figure>
					</div>
	                <div class="col-md-4">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part2/part2-density30-shaded.jpg" class="figure-img img-fluid rounded" alt="Density d = 30">
	                        <figcaption class="figure-caption text-center">Density d = 30</figcaption>
	                    </figure>
	                </div>
				</div>

				<p>As we can see, as we increase the density, the cloth has more folds in the resting hanging state. It makes sense because a higher density means a larger mass given the total volume. A larger mass means a larger magnitude of external force applied to each point mass, given the same amount of external accelerations. It also means a smaller acceleration by the spring forces of shearing constraint, because the spring force magnitudes stay the same but the mass on which the spring forces applied has increased. Therefore, the total net effects causing more changes in the cloth appearance.</p>

				<p>Below are side-by-side comparisons of the cloth with different damping.</p>

				<div class="row">
	                <div class="col-md-4">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part2/part2-damping0.06.jpg" class="figure-img img-fluid rounded" alt="Damping d = 0.06">
	                        <figcaption class="figure-caption text-center">Damping d = 0.06</figcaption>
	                    </figure>
	                </div>
	                <div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part2/part2-default.jpg" class="figure-img img-fluid rounded" alt="Default Damping">
					        <figcaption class="figure-caption text-center"><b>Default</b> Damping</figcaption>
					    </figure>
					</div>
	                <div class="col-md-4">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part2/part2-damping0.4.jpg" class="figure-img img-fluid rounded" alt="Damping d = 0.4">
	                        <figcaption class="figure-caption text-center">Damping d = 0.4</figcaption>
	                    </figure>
	                </div>
				</div>

				<div class="row">
	                <div class="col-md-4">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part2/part2-damping0.06-shaded.jpg" class="figure-img img-fluid rounded" alt="Damping d = 0.06">
	                        <figcaption class="figure-caption text-center">Damping d = 0.06</figcaption>
	                    </figure>
	                </div>
	                <div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part2/part2-default-shaded.jpg" class="figure-img img-fluid rounded" alt="Default Damping">
					        <figcaption class="figure-caption text-center"><b>Default</b> Damping</figcaption>
					    </figure>
					</div>
	                <div class="col-md-4">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part2/part2-damping0.4-shaded.jpg" class="figure-img img-fluid rounded" alt="Damping d = 0.4">
	                        <figcaption class="figure-caption text-center">Damping d = 0.4</figcaption>
	                    </figure>
	                </div>
				</div>

				<p>As we can see, with a higher damping value, the changes in cloth appearance is relatively small. However, we indeed can still notice effects on the folds where a higher damping seems to produce folds that are more towards the side and the bottom and are less strong. This makes sense as a higher damping value introduces more loss of energy, causing the effects to be smaller.</p>

				<p>Additionally, differences in damping also hugely impacts the animation of the falling cloths. For example, below shows two snapshots of the falling cloth, one with default damping d = 0.2, and one with low damping of d = 0.06. Specifically, we can find that cloths with low damping have more rippling when it falls, which makes sense as there's less loss of energy making the cloth look more bouncy and smooth.</p>

				<div class="row">
					<div class="col-md-6">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part2/part2-falling-low-damping.jpg" class="figure-img img-fluid rounded" alt="Falling Cloth with Default Damping">
	                        <figcaption class="figure-caption text-center">Falling Cloth with Default Damping</figcaption>
	                    </figure>
	                </div>
	                <div class="col-md-6">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part2/part2-falling-low-damping2.jpg" class="figure-img img-fluid rounded" alt="Falling Cloth with Low Damping">
	                        <figcaption class="figure-caption text-center">Falling Cloth with Low Damping</figcaption>
	                    </figure>
	                </div>
				</div>

				<p>Here is a simulation for a falling cloth with all four corners pinned:</p>

				<div class="text-center">
                    <figure class="figure">
                        <img src="./assets/img/result/part2/part2-pinned4-animation.gif" class="figure-img img-fluid rounded" alt="Shaded Cloth Animation">
                        <figcaption class="figure-caption text-center">Shaded Cloth Animation</figcaption>
                    </figure>
                </div>

				<p>Below are some views of a resting, shaded cloth with 4 corners pinned:</p>

				<div class="row">
					<div class="col-md-6">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part2/part2-pinned4-1.jpg" class="figure-img img-fluid rounded" alt="Shaded Resting Cloth View 1">
	                        <figcaption class="figure-caption text-center">Shaded Resting Cloth View 1</figcaption>
	                    </figure>
	                </div>
	                <div class="col-md-6">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part2/part2-pinned4-2.jpg" class="figure-img img-fluid rounded" alt="Shaded Resting Cloth View 2">
	                        <figcaption class="figure-caption text-center">Shaded Resting Cloth View 2</figcaption>
	                    </figure>
	                </div>
	                <div class="col-md-6">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part2/part2-pinned4-3.jpg" class="figure-img img-fluid rounded" alt="Shaded Resting Cloth View 3">
	                        <figcaption class="figure-caption text-center">Shaded Resting Cloth View 3</figcaption>
	                    </figure>
	                </div>
	                <div class="col-md-6">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part2/part2-pinned4-4.jpg" class="figure-img img-fluid rounded" alt="Shaded Resting Cloth View 4">
	                        <figcaption class="figure-caption text-center">Shaded Resting Cloth View 4</figcaption>
	                    </figure>
	                </div>
				</div>
				
				<h2 id="part3"><b>Part 3: Handling collisions with other objects</b></h2>

				<p>To make the sense look more interesting, I add support for cloth collision with other objects in the scene. Below I implemented collision support with spheres and planes.</p>

				<p>To simulate collision with a sphere, we check if the point mass intersects with or is inside the sphere. If so, we "bump" it up to the surface of the sphere and let the point move towards, accounting for friction, the tangent point at where the point mass should have intersected the sphere, if it had traveled in a straight line from its position towards the sphere's origin. </p>

				<p>Here are some simulations for a falling cloth onto a sphere:</p>

				<div class="row">
					<div class="col-md-6">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part3/sphere-wireframe.gif" class="figure-img img-fluid rounded" alt="Wireframe Cloth Animation">
	                        <figcaption class="figure-caption text-center">Wireframe Cloth Animation</figcaption>
	                    </figure>
	                </div>
	                <div class="col-md-6">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part3/sphere-shaded.gif" class="figure-img img-fluid rounded" alt="Shaded Cloth Animation">
	                        <figcaption class="figure-caption text-center">Shaded Cloth Animation</figcaption>
	                    </figure>
	                </div>
                </div>
				
				<p>Below are side-by-side comparisons of a resting cloth on the sphere with different spring constants.</p>

				<div class="row">
					<div class="col-md-6">
					    <figure class="figure">
					        <img src="./assets/img/result/part3/part3-k500.jpg" class="figure-img img-fluid rounded" alt="Spring Constant k = 500">
					        <figcaption class="figure-caption text-center">Spring Constant k = 500</figcaption>
					    </figure>
					</div>
					<div class="col-md-6">
					    <figure class="figure">
					        <img src="./assets/img/result/part3/part3-k5000.jpg" class="figure-img img-fluid rounded" alt="Spring Constant k = 5000">
					        <figcaption class="figure-caption text-center">Spring Constant k = 5000</figcaption>
					    </figure>
					</div>
					<div class="col-md-6">
					    <figure class="figure">
					        <img src="./assets/img/result/part3/part3-k50000.jpg" class="figure-img img-fluid rounded" alt="Spring Constant k = 50000">
					        <figcaption class="figure-caption text-center">Spring Constant k = 50000</figcaption>
					    </figure>
					</div>
					<div class="col-md-6">
					    <figure class="figure">
					        <img src="./assets/img/result/part3/part3-k5000-wireframe.jpg" class="figure-img img-fluid rounded" alt="Spring Constant k = 5000 Wireframe">
					        <figcaption class="figure-caption text-center">Spring Constant k = 5000 Wireframe</figcaption>
					    </figure>
					</div>
				</div>

				<p>As we can see, with a larger spring constant, the folds of the cloth when resting on the sphere tends to start from higher on the sphere surface and are more rigid to maintain its shape, letting edges of the cloth leaning more towards outside. In contrast, the cloth looks very smooth and soft and wraps around the ball more in a small spring constant case.</p>

				<p>We can also simulate collisions with a plane. We do so by checking if a point mass  moves from one side of the plane to the other in the last time step. If the point mass crosses over, we "bump" it back up to the side of the surface it originated from.</p>

				<p>Here are some simulations for a falling cloth onto a plane:</p>

				<div class="row">
					<div class="col-md-6">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part3/plane-wireframe.gif" class="figure-img img-fluid rounded" alt="Wireframe Cloth Animation">
	                        <figcaption class="figure-caption text-center">Wireframe Cloth Animation</figcaption>
	                    </figure>
	                </div>
	                <div class="col-md-6">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part3/plane-shaded.gif" class="figure-img img-fluid rounded" alt="Shaded Cloth Animation">
	                        <figcaption class="figure-caption text-center">Shaded Cloth Animation</figcaption>
	                    </figure>
	                </div>
                </div>

                <p>Below is a picture of a not-so-interesting cloth finally resting on the plane:</p>

                <div class="text-center">
                    <figure class="figure">
                        <img src="./assets/img/result/part3/part4-plane.jpg" class="figure-img img-fluid rounded" alt="A resting cloth on a plane" width="500px">
                        <figcaption class="figure-caption text-center">A resting cloth on a plane</figcaption>
                    </figure>
                </div>
				
				<h2 id="part4"><b>Part 4: Handling self-collisions</b></h2>
				
				<p>The cloth should also be able to collide with itself as it falls onto itself and folds itself. We achieve this effect by implementing cloth self-collision: we apply a repulsive collision force if any pair of point masses on the cloth are too close to each other.</p>

				<p>A naive method of implementing self collision is to loop through all pairs of point masses, compute the distance between them, and then apply a modifying force to the two point masses if they are within some threshold distance apart. However, this is O(N^2) time and is too inefficient for real-time simulations.</p> 

				<p>Instead, we accelerate it by using <b>spatial hashing</b>, where we divide the scene into equally sized 3D boxes and hash point masses to each of the boxes it resides in. Thus, we only need to compare the point masses within each 3D boxes. However, do note that it doesn't take care of the edge case when two point masses reside in different neighboring 3D boxes but also too close to each other because they are both very close to an edge. For the purpose of simplicity, I didn't take care of this case as it doesn't interfere with my simulation a lot.</p>

				<p>Here are some simulations for a falling cloth onto a plane:</p>

				<div class="row">
					<div class="col-md-6">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part4/part4-wireframe-animation.gif" class="figure-img img-fluid rounded" alt="Wireframe Cloth Animation">
	                        <figcaption class="figure-caption text-center">Wireframe Cloth Animation</figcaption>
	                    </figure>
	                </div>
	                <div class="col-md-6">
	                    <figure class="figure">
	                        <img src="./assets/img/result/part4/part4-shaded-animation.gif" class="figure-img img-fluid rounded" alt="Shaded Cloth Animation">
	                        <figcaption class="figure-caption text-center">Shaded Cloth Animation</figcaption>
	                    </figure>
	                </div>
                </div>

                <p>Below are screenshots of a falling cloth with default density (d = 15) and default spring constant (k = 5000). Take a look at how the cloth falls and folds on itself, starting with an early, initial self-collision and ending with the cloth at a more restful state.</p>

                <div class="row">
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part4/part4-default-1.jpg" class="figure-img img-fluid rounded" alt="Frame 1">
					        <figcaption class="figure-caption text-center">Frame 1</figcaption>
					    </figure>
					</div>
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part4/part4-default-2.jpg" class="figure-img img-fluid rounded" alt="Frame 2">
					        <figcaption class="figure-caption text-center">Frame 2</figcaption>
					    </figure>
					</div>
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part4/part4-default-3.jpg" class="figure-img img-fluid rounded" alt="Frame 3">
					        <figcaption class="figure-caption text-center">Frame 3</figcaption>
					    </figure>
					</div>
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part4/part4-default-4.jpg" class="figure-img img-fluid rounded" alt="Frame 4">
					        <figcaption class="figure-caption text-center">Frame 4</figcaption>
					    </figure>
					</div>
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part4/part4-default-5.jpg" class="figure-img img-fluid rounded" alt="Frame 5">
					        <figcaption class="figure-caption text-center">Frame 5</figcaption>
					    </figure>
					</div>
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part4/part4-default-6.jpg" class="figure-img img-fluid rounded" alt="Frame 6">
					        <figcaption class="figure-caption text-center">Frame 6</figcaption>
					    </figure>
					</div>
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part4/part4-default-7.jpg" class="figure-img img-fluid rounded" alt="Frame 7">
					        <figcaption class="figure-caption text-center">Frame 7</figcaption>
					    </figure>
					</div>
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part4/part4-default-8.jpg" class="figure-img img-fluid rounded" alt="Frame 8">
					        <figcaption class="figure-caption text-center">Frame 8</figcaption>
					    </figure>
					</div>
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part4/part4-default-9.jpg" class="figure-img img-fluid rounded" alt="Frame 9">
					        <figcaption class="figure-caption text-center">Frame 9</figcaption>
					    </figure>
					</div>
				</div>

				<p>Let's also observe how different parameters affect the behavior of the falling cloth.</p>

				<p>Below shows a falling cloth with a density of 06:</p>

				<div class="row">
					<div class="col-md-4">
	    				<figure class="figure">
					        <img src="./assets/img/result/part4/part4-d06-1.jpg" class="figure-img img-fluid rounded" alt="Frame 1">
					        <figcaption class="figure-caption text-center">Frame 1</figcaption>
					    </figure>
					</div>
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part4/part4-d06-2.jpg" class="figure-img img-fluid rounded" alt="Frame 2">
					        <figcaption class="figure-caption text-center">Frame 2</figcaption>
					    </figure>
					</div>
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part4/part4-d06-3.jpg" class="figure-img img-fluid rounded" alt="Frame 3">
					        <figcaption class="figure-caption text-center">Frame 3</figcaption>
					    </figure>
					</div>
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part4/part4-d06-4.jpg" class="figure-img img-fluid rounded" alt="Frame 4">
					        <figcaption class="figure-caption text-center">Frame 4</figcaption>
					    </figure>
					</div>
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part4/part4-d06-5.jpg" class="figure-img img-fluid rounded" alt="Frame 5">
					        <figcaption class="figure-caption text-center">Frame 5</figcaption>
					    </figure>
					</div>
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part4/part4-d06-6.jpg" class="figure-img img-fluid rounded" alt="Frame 6">
					        <figcaption class="figure-caption text-center">Frame 6</figcaption>
					    </figure>
					</div>
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part4/part4-d06-7.jpg" class="figure-img img-fluid rounded" alt="Frame 7">
					        <figcaption class="figure-caption text-center">Frame 7</figcaption>
					    </figure>
					</div>
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part4/part4-d06-8.jpg" class="figure-img img-fluid rounded" alt="Frame 8">
					        <figcaption class="figure-caption text-center">Frame 8</figcaption>
					    </figure>
					</div>
					<div class="col-md-4">
					    <figure class="figure">
					        <img src="./assets/img/result/part4/part4-d06-9.jpg" class="figure-img img-fluid rounded" alt="Frame 9">
					        <figcaption class="figure-caption text-center">Frame 9</figcaption>
					    </figure>
					</div>
				</div>

				<p>Below shows a falling cloth with a density of 30:</p>

				<div class="row">
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-d30-1.jpg" class="figure-img img-fluid rounded" alt="Frame 1">
                            <figcaption class="figure-caption text-center">Frame 1</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-d30-2.jpg" class="figure-img img-fluid rounded" alt="Frame 2">
                            <figcaption class="figure-caption text-center">Frame 2</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-d30-3.jpg" class="figure-img img-fluid rounded" alt="Frame 3">
                            <figcaption class="figure-caption text-center">Frame 3</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-d30-4.jpg" class="figure-img img-fluid rounded" alt="Frame 4">
                            <figcaption class="figure-caption text-center">Frame 4</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-d30-5.jpg" class="figure-img img-fluid rounded" alt="Frame 5">
                            <figcaption class="figure-caption text-center">Frame 5</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-d30-6.jpg" class="figure-img img-fluid rounded" alt="Frame 6">
                            <figcaption class="figure-caption text-center">Frame 6</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-d30-7.jpg" class="figure-img img-fluid rounded" alt="Frame 7">
                            <figcaption class="figure-caption text-center">Frame 7</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-d30-8.jpg" class="figure-img img-fluid rounded" alt="Frame 8">
                            <figcaption class="figure-caption text-center">Frame 8</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-d30-9.jpg" class="figure-img img-fluid rounded" alt="Frame 9">
                            <figcaption class="figure-caption text-center">Frame 9</figcaption>
                        </figure>
                    </div>
				</div>

				<p>As we can see, as we increase the density of the cloth, the cloth tends to have fewer subtle and small fold variations as it falls and folds itself. It also has larger and wider folds and tends to have more a bouncy look in a folded cloth for cloths with a large density.</p>

				<p>Below shows a falling cloth with a spring constant of 500:</p>

				<div class="row">
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-k500-1.jpg" class="figure-img img-fluid rounded" alt="Frame 1">
                            <figcaption class="figure-caption text-center">Frame 1</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-k500-2.jpg" class="figure-img img-fluid rounded" alt="Frame 2">
                            <figcaption class="figure-caption text-center">Frame 2</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-k500-3.jpg" class="figure-img img-fluid rounded" alt="Frame 3">
                            <figcaption class="figure-caption text-center">Frame 3</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-k500-4.jpg" class="figure-img img-fluid rounded" alt="Frame 4">
                            <figcaption class="figure-caption text-center">Frame 4</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-k500-5.jpg" class="figure-img img-fluid rounded" alt="Frame 5">
                            <figcaption class="figure-caption text-center">Frame 5</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-k500-6.jpg" class="figure-img img-fluid rounded" alt="Frame 6">
                            <figcaption class="figure-caption text-center">Frame 6</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-k500-7.jpg" class="figure-img img-fluid rounded" alt="Frame 7">
                            <figcaption class="figure-caption text-center">Frame 7</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-k500-8.jpg" class="figure-img img-fluid rounded" alt="Frame 8">
                            <figcaption class="figure-caption text-center">Frame 8</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-k500-9.jpg" class="figure-img img-fluid rounded" alt="Frame 9">
                            <figcaption class="figure-caption text-center">Frame 9</figcaption>
                        </figure>
                    </div>
				</div>

				<p>Below shows a falling cloth with a spring constant of 50000:</p>

				<div class="row">
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-k50000-1.jpg" class="figure-img img-fluid rounded" alt="Frame 1">
                            <figcaption class="figure-caption text-center">Frame 1</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-k50000-2.jpg" class="figure-img img-fluid rounded" alt="Frame 2">
                            <figcaption class="figure-caption text-center">Frame 2</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-k50000-3.jpg" class="figure-img img-fluid rounded" alt="Frame 3">
                            <figcaption class="figure-caption text-center">Frame 3</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-k50000-4.jpg" class="figure-img img-fluid rounded" alt="Frame 4">
                            <figcaption class="figure-caption text-center">Frame 4</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-k50000-5.jpg" class="figure-img img-fluid rounded" alt="Frame 5">
                            <figcaption class="figure-caption text-center">Frame 5</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-k50000-6.jpg" class="figure-img img-fluid rounded" alt="Frame 6">
                            <figcaption class="figure-caption text-center">Frame 6</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-k50000-7.jpg" class="figure-img img-fluid rounded" alt="Frame 7">
                            <figcaption class="figure-caption text-center">Frame 7</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-k50000-8.jpg" class="figure-img img-fluid rounded" alt="Frame 8">
                            <figcaption class="figure-caption text-center">Frame 8</figcaption>
                        </figure>
                    </div>
                    <div class="col-md-4">
                        <figure class="figure">
                            <img src="./assets/img/result/part4/part4-k50000-9.jpg" class="figure-img img-fluid rounded" alt="Frame 9">
                            <figcaption class="figure-caption text-center">Frame 9</figcaption>
                        </figure>
                    </div>
				</div>

				<p>As we can see, the effects of changing spring constants are much more obvious than changing clot density. As we increase the spring constant of the cloth, the cloth clearly tends to have way fewer tiny and varied fold. The cloth with larger spring constant tends to have a consistent smooth and rigid look. It also folds more smoothly and constantly because the internal spring forces will keep the cloth more in shape as it falls. The cloth with larger spring constant also has wider folds in resting states. </p>

			</div>
			<!-- End Post Content -->

			<!-- Begin Tags -->
			<div class="after-post-tags">
				<ul class="tags">
					<li><a href="#" class="disabled">Cloth Simulator</a></li>
					<li><a href="#" class="disabled">Physical Simulation</a></li>
					<li><a href="#" class="disabled">Animation</a></li>
					<li><a href="#" class="disabled">Computer Graphics</a></li>
				</ul>
			</div>
			<!-- End Tags -->

		</div>
		<!-- End Post -->

	</div>
</div>
<!-- End Article
================================================== -->

<div class="hideshare"></div>

<!-- Begin Footer
================================================== -->
<div class="container">
	<div class="footer">
		<p class="pull-left">
			 Copyright &copy; CS 184: Computer Graphics and Imaging, Spring 2018
		</p>
		<p class="pull-right">
			 Gan Tu
		</p>
		<div class="clearfix">
		</div>
	</div>
</div>
<!-- End Footer
================================================== -->

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="./assets/js/jquery.min.js"></script>
<script src="./assets/js/tether.min.js"></script>
<script src="./assets/js/bootstrap.min.js"></script>
<script src="./assets/js/ie10-viewport-bug-workaround.js"></script>
<script src="./assets/js/mediumish.js"></script>
<script src="./assets/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
	// ===== Scroll to Top ==== 
$(window).scroll(function() {
    if ($(this).scrollTop() >= 50) {        // If page is scrolled more than 50px
        $('#return-to-top').fadeIn(200);    // Fade in the arrow
    } else {
        $('#return-to-top').fadeOut(200);   // Else fade out the arrow
    }
});
$('#return-to-top').click(function() {      // When arrow is clicked
    $('body,html').animate({
        scrollTop : 0                       // Scroll to top of body
    }, 500);
});
// update date automatically
// var d = new Date();
// var months = ["Jan", "Feb", "March", "April", "May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec"];
// var dateToShow = d.getDate();
// dateToShow = dateToShow + " " + months[d.getMonth()];
// dateToShow = dateToShow + " ";
// dateToShow = dateToShow + d.getFullYear();
// document.getElementById("post-date").innerHTML = dateToShow;
</script>
</body>
</html>
